<!-- fairs/templates/stallregistrations/available_sites_partial.html -->

{% load static %}

<div id="site_allocation_data">
    <div class="badge bg-info text-dark text-wrap" style="width: auto;">
        {{ site_filter }}
    </div>
    <hr>
    <div class="row g-3 ">
        <form action="." method="post">
            {% csrf_token %}
            <button id='submitbtn' class='btn btn-primary' type='submit'>Allocate Site(s)</button>
            <a type="button" class="btn btn-secondary" href="javascript:window.history.back()">Cancel</a>
            <hr>
            {% if site_list %}
            <div  class="table-responsive-lg">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col">Site</th>
                            <th scope="col">Event</th>
                            <th scope="col">Site Size</th>
                            <th scope="col">Power</th>
                            <th scope="col">Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for site in site_list %}
                        <tr>
                            <td><input type="checkbox" class="me-2" name="eventsites" value={{ site.id }}>{{ site.site }}</td>
                            <td>{{ site.event }}</td>
                            <td>{{ site.site.site_size }}</td>
                            <td>
                                {% if site.site.has_power and site.powerbox_info %}
                                    {% if site.powerbox_info.free > 0 %}
                                        <span class="badge bg-success">
                                            ⚡ {{ site.powerbox_info.free }} / {{ site.powerbox_info.total }}
                                        </span>
                                    {% else %}
                                        <span class="badge bg-danger">
                                            ⚡ 0 / {{ site.powerbox_info.total }}
                                        </span>
                                    {% endif %}
                                    <small class="text-muted d-block">{{ site.powerbox_info.powerbox }}</small>
                                {% else %}
                                    <span class="badge bg-secondary">No Power</span>
                                {% endif %}
                            </td>
                            <td>{{ site.notes }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% endif %}
        </form>
    </div>
</div>